webpackJsonp([9],{110:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return{data:{treeView:[]},config:{userID:0,userName:"",userUserName:"",userBranchName:"",searchBox:{searchVal:"",placeholder:"搜索部门权限",suggest:{isShow:1,data:[]}},treeView:{isShow:1,isShowIcon:2,showChoice:!0,keyConfig:{name:"RoleName",id:"Id",childKey:"ChildList"},locationConfig:{key:"id"}},modalBox:{isShow:!1,content:"",btn:[{text:"确定",handel:"confirmClick"},{text:"取消",handel:"cancelClick"}]}}}};t.default={data:function(){return new a},activated:function(){var e=this;Bestone.ui.pageInit({setTitle:"配置权限管理",reviewCallBack:function(){e.config.userID=Bestone.util.query().UserID||0,e.config.userName=Bestone.util.query().UserName||"",e.config.userUserName=Bestone.util.query().UserUserName||"",e.config.userBranchName=Bestone.util.query().UserBranchName||"",Bestone.util.ajax({url:"api/AuthManage/GetRolesByKeyword",data:JSON.stringify({Keyword:""}),success:function(t){e.config.searchBox.suggest.data=Bestone.util.getTreeViewDataForSearch({data:t.data||[],name:"RoleName",id:"Id",childKey:"ChildList"}),e.data.treeView=t.data||[]}})}}),Bestone.ui.ddSetRight({control:!0,text:"提交",show:!0,onSuccess:function(){e.submitConfig()}})},deactivated:function(){var e=this;Bestone.util.resetData(function(){e.data=a().data,e.config=a().config})},methods:{submitConfig:function(){var e=this,t="";if($.each(e.data.treeView,function(e,i){i.frontActive&&1===i.frontActive&&(t=t+i.Id+",")}),t.length<=0)return void Bestone.ui.message({content:"请至少选择一个部门"});e.config.modalBox.content='<p style="font-size: 14px;text-align: center;padding: 20px 0px;line-height: 16px;">确定提交？</p>',e.config.modalBox.isShow=!0},confirmClickDeal:function(){var e=this,t="";if($.each(e.data.treeView,function(e,i){i.frontActive&&1===i.frontActive&&(t=t+i.Id+",")}),t.length<=0)return void Bestone.ui.message({content:"请至少选择一个部门"});t=t.substring(0,t.length-1),Bestone.util.ajax({url:"api/AuthManage/AddRoleManange",data:JSON.stringify({UserId:e.config.userID,RoleIds:t,OperId:Bestone.user.id,OperName:Bestone.user.name}),success:function(t){Bestone.ui.message({content:"权限管理配置成功",notOper:!0}),e.config.modalBox.isShow=!1,setTimeout(function(){window.app.$router.go(-1)},500)}})},cancelClickDeal:function(){this.config.modalBox.isShow=!1},searchClickDeal:function(e){Bestone.ui.message({content:"仅支持智能匹配搜索"})},searchValChangeDeal:function(e){this.config.searchBox.searchVal=e},itemClickDeal:function(e){var t=e.id;if(t){var i=$(".ui.tree-view .loca"+t);$(".ui.tree-view .item").css("background-color","transparent"),i.length>0&&setTimeout(function(){i.css("background-color","#FFFBE6"),$(window).scrollTop(i.offset().top-5)},100)}},dataArrChangeDeal:function(e){this.data.treeView=e}}}},141:function(e,t,i){t=e.exports=i(0)(void 0),t.push([e.i,"#permission-mgmt[data-v-b216bdee]{padding-top:10px;padding-bottom:10px}#permission-mgmt>.search-content[data-v-b216bdee]{border-top:1px solid #eee;background-color:#fff;padding:10px 15px}#permission-mgmt>.ui-title[data-v-b216bdee]{margin-top:10px}#permission-mgmt>.tree-view-content[data-v-b216bdee]{border-bottom:1px solid #eee}",""])},174:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{attrs:{id:"permission-mgmt"}},[i("div",{staticClass:"ui ui-text-list"},[i("p",[e._v("TDS账号："+e._s(e.config.userName))]),e._v(" "),i("p",[e._v("姓名："+e._s(e.config.userUserName))]),e._v(" "),i("p",[e._v("账号所属公司："+e._s(e.config.userBranchName))])]),e._v(" "),""!==e.config.selectChoiceId?i("div",{staticClass:"search-content"},[i("search-box",{attrs:{searchVal:e.config.searchBox.searchVal,placeholder:e.config.searchBox.placeholder,suggest:e.config.searchBox.suggest},on:{searchClick:e.searchClickDeal,searchValChange:e.searchValChangeDeal,itemClick:e.itemClickDeal}})],1):e._e(),e._v(" "),i("div",{staticClass:"ui ui-title"},[e._v("配置权限管理部门")]),e._v(" "),""!==e.config.selectChoiceId?i("div",{staticClass:"tree-view-content"},[i("tree-view",{attrs:{dataArr:e.data.treeView,setConfig:e.config.treeView},on:{dataArrChange:e.dataArrChangeDeal}})],1):e._e(),e._v(" "),e._e(),e._v(" "),i("modal-box",{attrs:{setConfig:e.config.modalBox},on:{confirmClick:e.confirmClickDeal,cancelClick:e.cancelClickDeal}})],1)])},staticRenderFns:[]}},205:function(e,t,i){var a=i(141);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(2)("07db9650",a,!0)},79:function(e,t,i){function a(e){i(205)}var n=i(1)(i(110),i(174),a,"data-v-b216bdee",null);e.exports=n.exports}});