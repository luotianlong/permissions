webpackJsonp([24],{124:function(e,t,a){t=e.exports=a(0)(void 0),t.push([e.i,'#mgmt-limit[data-v-12fd3de2]{padding-top:10px;padding-bottom:10px}#mgmt-limit>.tab[data-v-12fd3de2]{background-color:#fff;height:40px;overflow:hidden;border-bottom:1px solid #eee;margin-bottom:10px}#mgmt-limit>.tab>.item[data-v-12fd3de2]{position:relative;width:50%;height:40px;float:left;line-height:40px;font-size:14px;color:#666;text-align:center;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#mgmt-limit>.tab>.item[data-v-12fd3de2]:after{content:"";position:absolute;width:1px;height:26px;background-color:#eee;top:7px;right:0}#mgmt-limit>.tab>.item.action[data-v-12fd3de2]{color:#38adff}#mgmt-limit>.tab>.item.action[data-v-12fd3de2]:before{content:"";position:absolute;width:99%;height:1px;background-color:#38adff;top:0;left:0}#mgmt-limit>.tab>.item[data-v-12fd3de2]:last-child{float:right}#mgmt-limit>.tab>.item[data-v-12fd3de2]:last-child:after{width:0}#mgmt-limit>.tab>.item:last-child.action[data-v-12fd3de2]:before{right:0;left:auto}#mgmt-limit .page-two>.search[data-v-12fd3de2],#mgmt-limit>.page-one>.search[data-v-12fd3de2]{background-color:#fff;padding:10px 15px}#mgmt-limit .page-two>.tree-view-content[data-v-12fd3de2],#mgmt-limit>.page-one>.tree-view-content[data-v-12fd3de2]{margin-top:10px}#mgmt-limit .page-two>.tree-view-content>.no-data[data-v-12fd3de2],#mgmt-limit>.page-one>.tree-view-content>.no-data[data-v-12fd3de2]{color:#999;font-size:12px;line-height:20px;text-align:center;margin-top:50px;padding:0 20px}#mgmt-limit>.page-one>.help-choice[data-v-12fd3de2]{background-color:#fff;border-top:1px solid #eee;padding:15px;padding-top:0}#mgmt-limit>.page-one>.help-choice>ul[data-v-12fd3de2]{overflow:hidden;font-size:0}#mgmt-limit>.page-one>.help-choice>ul>li[data-v-12fd3de2]{float:left;margin-top:15px;margin-right:20px}#mgmt-limit>.other-checkbox[data-v-12fd3de2]{background-color:#fff;margin-top:10px}#mgmt-limit>.other-checkbox>ul>li[data-v-12fd3de2]{cursor:pointer;min-height:16px;padding:12px 15px;border-bottom:1px solid #eee;font-size:0}',""])},157:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{attrs:{id:"mgmt-limit"}},[e.config.isShowTab?a("div",{staticClass:"tab"},[a("v-touch",{staticClass:"item",class:1===e.config.tabIndex?"action":"",attrs:{tag:"div"},on:{tap:function(t){t.preventDefault(),e.switchTab(1)},pressup:function(t){t.preventDefault(),e.switchTab(1)}}},[e._v("按公司")]),e._v(" "),a("v-touch",{staticClass:"item",class:2===e.config.tabIndex?"action":"",attrs:{tag:"div"},on:{tap:function(t){t.preventDefault(),e.switchTab(2)},pressup:function(t){t.preventDefault(),e.switchTab(2)}}},[e._v("按门市")])],1):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.config.tabIndex,expression:"config.tabIndex===1"}],staticClass:"page-one"},[a("div",{staticClass:"ui ui-title"},[e._v("选择业务管理范围")]),e._v(" "),a("div",{staticClass:"search"},[a("search-box",{attrs:{searchVal:e.config.pageOne.searchBox.searchVal,placeholder:e.config.pageOne.searchBox.placeholder,suggest:e.config.pageOne.searchBox.suggest},on:{searchClick:e.pageOneClickDeal,searchValChange:e.pageOneValChangeDeal,itemClick:e.pageOneItemClickDeal}})],1),e._v(" "),a("div",{staticClass:"help-choice"},[a("ul",e._l(e.config.pageOne.helpChoice,function(t,i){return a("li",[a("v-touch",{staticClass:"ui ui-checkbox",class:t.checked?"checked":"",attrs:{tag:"div"},on:{tap:function(a){a.preventDefault(),e.clickHelpCheckBox(t,i)},pressup:function(a){a.preventDefault(),e.clickHelpCheckBox(t,i)}}},[a("span",{staticClass:"icon-content"},[a("i",{staticClass:"iconfont icon-gou"})]),a("span",{staticClass:"text"},[e._v(e._s(t.text))])])],1)}))]),e._v(" "),a("div",{staticClass:"tree-view-content"},[0==e.data.pageOne.treeView.length?a("div",{staticClass:"no-data",staticStyle:{"margin-top":"0px","margin-bottom":"10px"}},[e._v("暂无数据")]):e._e(),e._v(" "),a("tree-view",{attrs:{dataArr:e.data.pageOne.treeView,setConfig:e.config.pageOne.treeView},on:{dataArrChange:e.pageOneTreeDataChangeDeal}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.config.tabIndex,expression:"config.tabIndex===2"}],staticClass:"page-two"},[a("div",{staticClass:"search"},[a("search-box",{attrs:{searchVal:e.config.pageTwo.searchBox.searchVal,placeholder:e.config.pageTwo.searchBox.placeholder,suggest:e.config.pageTwo.searchBox.suggest},on:{searchClick:e.pageTwoClickDeal,searchValChange:e.pageTwoValChangeDeal,itemClick:e.pageTwoItemClickDeal}})],1),e._v(" "),a("div",{staticClass:"tree-view-content"},[0==e.data.pageTwo.treeView.length?a("div",{staticClass:"no-data",staticStyle:{"margin-top":"0px","margin-bottom":"10px"}},[e._v("暂无数据")]):e._e(),e._v(" "),a("tree-view",{attrs:{dataArr:e.data.pageTwo.treeView,setConfig:e.config.pageTwo.treeView},on:{dataArrChange:e.pageTwoTreeDataChangeDeal}})],1)]),e._v(" "),a("div",{staticClass:"other-checkbox"},[a("ul",e._l(e.config.otherCheckbox,function(t,i){return a("v-touch",{attrs:{tag:"li"},on:{tap:function(a){a.preventDefault(),e.clickOtherCheckBox(t,i)},pressup:function(a){a.preventDefault(),e.clickOtherCheckBox(t,i)}}},[a("div",{staticClass:"ui ui-checkbox",class:t.checked?"checked":""},[a("span",{staticClass:"icon-content"},[a("i",{staticClass:"iconfont icon-gou"})]),a("span",{staticClass:"text"},[e._v(e._s(t.Value))])])])}))]),e._v(" "),e._e()])])},staticRenderFns:[]}},188:function(e,t,a){var i=a(124);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(2)("e5c89b04",i,!0)},63:function(e,t,a){function i(e){a(188)}var n=a(1)(a(94),a(157),i,"data-v-12fd3de2",null);e.exports=n.exports},94:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return{data:{pageOne:{treeView:[]},pageTwo:{treeView:[]}},config:{tabIndex:1,isShowTab:!1,otherCheckbox:[],pageOne:{helpChoice:[{text:"全选",category:0},{text:"自有公司",category:1},{text:"合资公司",category:2},{text:"合作社",category:3},{text:"旅景",category:4},{text:"携程",category:5},{text:"悠程",category:6}],searchBox:{searchVal:"",placeholder:"公司名称",suggest:{isShow:1,data:[]}},treeView:{isShow:1,isShowIcon:1,showChoice:!0,keyConfig:{name:"Branch_Name",id:"Branch_ID",childKey:"ChildList"},locationConfig:{key:"id"}}},pageTwo:{searchBox:{searchVal:"",placeholder:"门市名称/门市所属公司名称",suggest:{isShow:1,data:[]}},treeView:{isShow:1,isShowIcon:1,showChoice:!0,isActive:!1,keyConfig:{name:"BranchName",id:"BranchId",childKey:"ChildList"},locationConfig:{key:"id"}}}}}};t.default={data:function(){return new i},activated:function(){var e=this;Bestone.ui.pageInit({setTitle:"管理范围选择",reviewCallBack:function(){if(0===Bestone.applyData.RoleId)return Bestone.ui.message({content:"数据已失效，请重新申请",notOper:!0}),void setTimeout(function(){window.app.$router.go(-1)},1e3);[17,4,21].indexOf(Bestone.util.query().MenuBusinessType)>=0&&(e.config.isShowTab=!0),Bestone.util.ajax({url:"api/PermissionManage/GetAllRoleBranch",data:JSON.stringify({}),success:function(t){e.config.pageOne.searchBox.suggest.data=Bestone.util.getTreeViewDataForSearch({data:t.data||[],name:"Branch_Name",id:"Branch_ID",childKey:"ChildList"}),e.data.pageOne.treeView=t.data||[]}}),Bestone.util.ajax({url:"api/PermissionManage/GetRoleBranch",data:JSON.stringify({BussinessType:1,Key:""}),success:function(t){e.config.pageTwo.searchBox.suggest.data=Bestone.util.getTreeViewDataForSearch({data:t.data||[],name:"BranchName",id:"BranchId",childKey:"ChildList"}),e.data.pageTwo.treeView=t.data||[]}}),Bestone.util.ajax({url:"api/PermissionManage/GetMenuRoleButtons?menuId="+Bestone.util.query().MenuId,data:JSON.stringify({}),success:function(t){e.config.otherCheckbox=t.data||[]}})}}),Bestone.ui.ddSetRight({control:!0,text:"确定",show:!0,onSuccess:function(){e.submit()}})},deactivated:function(){var e=this;Bestone.util.resetData(function(){e.data=i().data,e.config=i().config})},methods:{switchTab:function(e){this.config.tabIndex=e},clickOtherCheckBox:function(e,t){var a=this,i=e;i.checked?i.checked=!1:i.checked=!0,a.config.otherCheckbox.splice(t,1,i)},submit:function(){var e=this,t={MenuID:parseInt(Bestone.util.query().MenuId,10),BranchIds:[],ButtonIds:[],MenuName:Bestone.util.query().MenuName||"",BranchNames:[],ButtonNames:[]};if(1===e.config.tabIndex){!function e(a){$.each(a,function(a,i){i.frontActive&&1===i.frontActive&&(t.BranchIds.push(i.Branch_ID),t.BranchNames.push(i.Branch_Name)),i.ChildList&&i.ChildList.length>0&&e(i.ChildList)})}(e.data.pageOne.treeView)}else $.each(e.data.pageTwo.treeView,function(e,a){a.frontActive&&1===a.frontActive&&(t.BranchIds.push(a.BranchId),t.BranchNames.push(a.BranchName))});if(t.BranchIds.length<=0)return void Bestone.ui.message({content:"请至少选择一家公司或门市"});$.each(e.config.otherCheckbox,function(e,a){a.checked&&(t.ButtonIds.push(parseInt(a.Id,10)),t.ButtonNames.push(a.Value))});var a=!1;$.each(Bestone.applyData.MenuArr,function(e,i){if(i.MenuID==t.MenuID)return Bestone.applyData.MenuArr.splice(e,1,t),a=!0,!1}),a||Bestone.applyData.MenuArr.push(t),window.app.$router.go(-1)},pageOneClickDeal:function(e){Bestone.ui.message({content:"仅支持智能匹配搜索"})},pageOneValChangeDeal:function(e){this.config.pageOne.searchBox.searchVal=e},pageOneItemClickDeal:function(e){var t=e.id;if(t){var a=$(".page-one .ui.tree-view .loca"+t);$(".page-one .ui.tree-view .item").css("background-color","transparent"),a.length>0&&setTimeout(function(){a.css("background-color","#FFFBE6"),$(window).scrollTop(a.offset().top-5)},100)}},clickHelpCheckBox:function(e,t){function a(n){$.each(n,function(o,c){if(c.Branch_Category===e.category||0===e.category){var s=c;i.config.pageOne.helpChoice[t].checked?s.frontActive=1:s.frontActive=2,n.splice(o,1,s)}c.ChildList&&c.ChildList.length>0&&a(c.ChildList)})}var i=this,n=e;n.checked?n.checked=!1:n.checked=!0,i.config.pageOne.helpChoice.splice(t,1,n),a(i.data.pageOne.treeView)},pageOneTreeDataChangeDeal:function(e){this.data.pageOne.treeView=e},pageTwoClickDeal:function(e){Bestone.ui.message({content:"仅支持智能匹配搜索"})},pageTwoValChangeDeal:function(e){this.config.pageTwo.searchBox.searchVal=e},pageTwoItemClickDeal:function(e){var t=e.id;if(t){var a=$(".page-two .ui.tree-view .loca"+t);$(".page-two .ui.tree-view .item").css("background-color","transparent"),a.length>0&&setTimeout(function(){a.css("background-color","#FFFBE6"),$(window).scrollTop(a.offset().top-5)},100)}},pageTwoTreeDataChangeDeal:function(e){this.data.pageTwo.treeView=e}}}}});