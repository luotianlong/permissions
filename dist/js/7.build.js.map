{"version":3,"sources":["webpack:///js/7.build.js","webpack:///deptConfigDetail.vue","webpack:///./src/component/permissionMgmtConfig/deptConfigDetail.vue?d41d","webpack:///./src/component/permissionMgmtConfig/deptConfigDetail.vue?2c31","webpack:///./src/component/permissionMgmtConfig/deptConfigDetail.vue?d6ea","webpack:///./src/component/permissionMgmtConfig/deptConfigDetail.vue"],"names":["webpackJsonp","112","module","__webpack_exports__","__webpack_require__","Object","defineProperty","value","initData","data","treeView","config","deptNameVal","searchBox","searchVal","placeholder","suggest","isShow","isShowIcon","showChoice","choiceConfig","choiceChild","keyConfig","name","id","childKey","locationConfig","key","modalBox","content","btn","text","handel","activated","self","this","Bestone","ui","pageInit","setTitle","reviewCallBack","util","query","RoleName","ajax","url","JSON","stringify","Keyword","success","ajaxData","getTreeViewDataForSearch","RoleId","activeMenuCodes","$","each","k","v","ChildList","push","MenuCode","indexOf","thisItem","frontActive","splice","ddSetRight","control","show","onSuccess","submitConfig","deactivated","resetData","methods","length","message","menuCodes","confirmClickDeal","substring","Id","MenuCodes","OperId","user","OperName","notOper","setTimeout","window","app","$router","go","cancelClickDeal","searchClickDeal","str","searchValChangeDeal","itemClickDeal","item","val","$loca","css","scrollTop","offset","top","dataArrChangeDeal","arr","131","exports","undefined","i","164","render","_vm","_h","$createElement","_c","_self","attrs","staticClass","directives","rawName","expression","type","domProps","on","input","$event","target","composing","_v","selectChoiceId","searchClick","searchValChange","itemClick","_e","dataArr","setConfig","dataArrChange","confirmClick","cancelClick","staticRenderFns","195","locals","81","injectStyle","ssrContext","Component"],"mappings":"AAAAA,cAAc,IAERC,IACA,SAAUC,EAAQC,EAAqBC,GAE7C,YACAC,QAAOC,eAAeH,EAAqB,cAAgBI,OAAO,GCiBlE,IAAAC,GAAA,WDQI,OACIC,MACIC,aAEJC,QACIC,YAAa,GACbC,WACIC,UCNhB,GDOgBC,YCNhB,ODOgBC,SACIC,OCNpB,EDOoBR,UAGRC,UACIO,OCNhB,EDOgBC,WCNhB,EDOgBC,YCNhB,EDOgBC,cACIC,aCLpB,GDOgBC,WACIC,KCNpB,WDOoBC,GCNpB,WDOoBC,SCLpB,aDOgBC,gBACIC,ICJpB,ODOYC,UACIX,QCNhB,EDOgBY,QCNhB,GDOgBC,MACIC,KCNpB,KDOoBC,OCNpB,iBDQoBD,KCNpB,KDOoBC,OCFpB,mBACA7B,GAAA,SDQIM,KAAM,WACF,MAAO,ICNfD,IDSIyB,UAAW,WACP,GAAIC,GCPZC,IDQQC,SAAQC,GAAGC,UACPC,SCPZ,WDQYC,eAAgB,WACZN,EAAKvB,OAAOC,YAAcwB,QAAQK,KAAKC,QAAQC,UCP/D,GDSgBP,QAAQK,KAAKG,MACTC,ICPpB,6BDQoBpC,KAAMqC,KAAKC,WACPC,QCNxB,KDQoBC,QAAS,SAAiBC,GACtBhB,EAAKvB,OAAOE,UAAUG,QAAQP,KAAO2B,QAAQK,KAAKU,0BAC9C1C,KAAMyC,EAASzC,SACfc,KCP5B,WDQ4BC,GCP5B,WDQ4BC,SCN5B,cDQwBS,EAAKzB,KAAKC,SAAWwC,EAASzC,UAGxB2B,QAAQK,KAAKC,QAAQU,QAA0C,IAAhChB,QAAQK,KAAKC,QAAQU,SACtDhB,QAAQK,KAAKG,MACTC,ICPhC,8BDQgCpC,KAAMqC,KAAKC,WACPK,OAAQhB,QAAQK,KAAKC,QCNzDU,SDQgCH,QAAS,SAAiBC,GACtB,GAAIG,KAEJC,GAAEC,KAAKL,EAASzC,KAAM,SAAU+C,EAAGC,GAC/BH,EAAEC,KAAKE,EAAEC,UAAW,SAAU/B,EAAKpB,GAC/B8C,EAAgBM,KAAKpD,ECPjEqD,cDWoCN,EAAEC,KAAKrB,EAAKzB,KAAKC,SAAU,SAAU8C,EAAGC,GACpCH,EAAEC,KAAKE,EAAEC,UAAW,SAAU/B,EAAKpB,GAC/B,GAAI8C,EAAgBQ,QAAQtD,EAAMqD,WAAa,ECP3F,CDQgD,GAAIE,GCPpDvD,CDQgDuD,GAASC,YCPzD,EDQgD7B,EAAKzB,KAAKC,SAAS8C,GAAGE,UAAUM,OAAOrC,EAAK,ECP5FmC,iBDmBQ1B,QAAQC,GAAG4B,YACPC,SCPZ,EDQYnC,KCPZ,KDQYoC,MCPZ,EDQYC,UAAW,WACPlC,ECPhBmC,mBDWIC,YAAa,WACT,GAAIpC,GCPZC,IDSQC,SAAQK,KAAK8B,UAAU,WACnBrC,EAAKzB,KAAOD,ICPxBC,KDQYyB,EAAKvB,OAASH,ICP1BG,UDUI6D,SAEIH,aAAc,WACV,GAAInC,GCNhBC,IDQY,IAAID,EAAKvB,OAAOC,YAAY6D,QAAU,ECHlD,WDIgBrC,SAAQC,GAAGqC,SACP7C,QCNpB,YDWY,IAAI8C,GCPhB,EDeY,IAPArB,EAAEC,KAAKrB,EAAKzB,KAAKC,SAAU,SAAU8C,EAAGC,GACpCH,EAAEC,KAAKE,EAAEC,UAAW,SAAU/B,EAAKpB,GACzBA,EAAMwD,aAAqC,IAAtBxD,EAAMwD,cAC7BY,EAAYA,EAAYpE,EAAMqD,SCPtD,SDWgBe,EAAUF,QAAU,ECHpC,WDIgBrC,SAAQC,GAAGqC,SACP7C,QCNpB,aDWYK,GAAKvB,OAAOiB,SAASC,QCPjC,iGDQYK,EAAKvB,OAAOiB,SAASX,QCPjC,GDUQ2D,iBAAkB,WACd,GAAI1C,GCNhBC,IDQY,IAAID,EAAKvB,OAAOC,YAAY6D,QAAU,ECHlD,WDIgBrC,SAAQC,GAAGqC,SACP7C,QCNpB,YDWY,IAAI8C,GCPhB,EDeY,IAPArB,EAAEC,KAAKrB,EAAKzB,KAAKC,SAAU,SAAU8C,EAAGC,GACpCH,EAAEC,KAAKE,EAAEC,UAAW,SAAU/B,EAAKpB,GACzBA,EAAMwD,aAAqC,IAAtBxD,EAAMwD,cAC7BY,EAAYA,EAAYpE,EAAMqD,SCPtD,SDWgBe,EAAUF,QAAU,ECHpC,WDIgBrC,SAAQC,GAAGqC,SACP7C,QCNpB,aDUY8C,GAAYA,EAAUE,UAAU,EAAGF,EAAUF,OAAS,GAEhDrC,QAAQK,KAAKC,QAAQU,QAA0C,IAAhChB,QAAQK,KAAKC,QAAQU,OAEtDhB,QAAQK,KAAKG,MACTC,ICRpB,4BDSoBpC,KAAMqC,KAAKC,WACP+B,GAAI1C,QAAQK,KAAKC,QCRzCU,ODSwBT,SAAUT,EAAKvB,OCRvCC,YDSwBmE,UCRxBJ,EDSwBK,OAAQ5C,QAAQ6C,KCRxCzD,GDSwB0D,SAAU9C,QAAQ6C,KCP1C1D,ODSoB0B,QAAS,SAAiBC,GACtBd,QAAQC,GAAGqC,SACP7C,QCR5B,ODS4BsD,SCP5B,IDSwBjD,EAAKvB,OAAOiB,SAASX,QCR7C,EDSwBmE,WAAW,WACPC,OAAOC,IAAIC,QAAQC,ICR/C,IACA,QDagBpD,QAAQK,KAAKG,MACTC,ICTpB,yBDUoBpC,KAAMqC,KAAKC,WACPJ,SAAUT,EAAKvB,OCTvCC,YDUwBmE,UCTxBJ,EDUwBK,OAAQ5C,QAAQ6C,KCTxCzD,GDUwB0D,SAAU9C,QAAQ6C,KCR1C1D,ODUoB0B,QAAS,SAAiBC,GACtBd,QAAQC,GAAGqC,SACP7C,QCT5B,ODU4BsD,SCR5B,IDUwBjD,EAAKvB,OAAOiB,SAASX,QCT7C,EDUwBmE,WAAW,WACPC,OAAOC,IAAIC,QAAQC,ICT/C,IACA,SDeQC,gBAAiB,WCRzBtD,KDUiBxB,OAAOiB,SAASX,QCTjC,GDYQyE,gBAAiB,SAAyBC,GACtCvD,QAAQC,GAAGqC,SACP7C,QCRhB,eDYQ+D,oBAAqB,SAA6BD,GAC9CxD,KAAKxB,OAAOE,UAAUC,UAAY6E,GAGtCE,cAAe,SAAuBC,GAClC,GAAIC,GAAMD,ECTtBtE,EDUY,IAAMuE,ECTlB,CDUgB,GAAIC,GAAQ1C,EAAE,sBCT9ByC,EDUgBzC,GAAE,uBAAuB2C,IAAI,mBCT7C,eDUoBD,EAAMvB,OAAS,GACfW,WAAW,WACPY,EAAMC,IAAI,mBCTlC,WDUwB3C,EAAE+B,QAAQa,UAAUF,EAAMG,SAASC,ICT3D,IACA,ODcQC,kBAAmB,SAA2BC,GCRtDnE,KDUiB1B,KAAKC,SCTtB4F,MDgBMC,IACA,SAAUrG,EAAQsG,EAASpG,GErSjCoG,EAAAtG,EAAAsG,QAAApG,EAAA,OAAAqG,IAKAD,EAAA7C,MAAAzD,EAAAwG,EAAA,gYAAuZ,MF8SjZC,IACA,SAAUzG,EAAQsG,GGpTxBtG,EAAAsG,SAAgBI,OAAA,WAAmB,GAAAC,GAAA1E,KAAa2E,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAC1E,OAAAE,GAAA,OAAAA,EAAA,OACAE,OACA1F,GAAA,wBAEGwF,EAAA,OACHG,YAAA,cACGH,EAAA,OACHG,YAAA,gBACGH,EAAA,SACHI,aACA7F,KAAA,QACA8F,QAAA,UACA9G,MAAAsG,EAAAlG,OAAA,YACA2G,WAAA,uBAEAJ,OACAK,KAAA,OACAxG,YAAA,SACAQ,KAAA,YAEAiG,UACAjH,MAAAsG,EAAAlG,OAAA,aAEA8G,IACAC,MAAA,SAAAC,GACAA,EAAAC,OAAAC,YACAhB,EAAAlG,OAAAC,YAAA+G,EAAAC,OAAArH,eAGGsG,EAAAiB,GAAA,UAAAjB,EAAAlG,OAAAoH,eAAAf,EAAA,OACHG,YAAA,mBACGH,EAAA,cACHE,OACApG,UAAA+F,EAAAlG,OAAAE,UAAAC,UACAC,YAAA8F,EAAAlG,OAAAE,UAAAE,YACAC,QAAA6F,EAAAlG,OAAAE,UAAAG,SAEAyG,IACAO,YAAAnB,EAAAnB,gBACAuC,gBAAApB,EAAAjB,oBACAsC,UAAArB,EAAAhB,kBAEG,GAAAgB,EAAAsB,KAAAtB,EAAAiB,GAAA,UAAAjB,EAAAlG,OAAAoH,eAAAf,EAAA,OACHG,YAAA,sBACGH,EAAA,aACHE,OACAkB,QAAAvB,EAAApG,KAAAC,SACA2H,UAAAxB,EAAAlG,OAAAD,UAEA+G,IACAa,cAAAzB,EAAAR,sBAEG,GAAAQ,EAAAsB,KAAAtB,EAAAiB,GAAA,KAiBAjB,EAAAsB,KAAAtB,EAAAiB,GAAA,KAAAd,EAAA,aACHE,OACAmB,UAAAxB,EAAAlG,OAAAiB,UAEA6F,IACAc,aAAA1B,EAAAjC,iBACA4D,YAAA3B,EAAApB,oBAEG,MACFgD,qBH0TKC,IACA,SAAUxI,EAAQsG,EAASpG,GIvYjC,GAAAyB,GAAAzB,EAAA,IACA,iBAAAyB,SAAA3B,EAAAwG,EAAA7E,EAAA,MACAA,EAAA8G,SAAAzI,EAAAsG,QAAA3E,EAAA8G,OAEAvI,GAAA,cAAAyB,GAAA,IJgZM+G,GACA,SAAU1I,EAAQsG,EAASpG,GKxZjC,QAAAyI,GAAAC,GACA1I,EAAA,KAEA,GAAA2I,GAAA3I,EAAA,GAEAA,EAAA,KAEAA,EAAA,KAEAyI,EAEA,kBAEA,KAGA3I,GAAAsG,QAAAuC,EAAAvC","file":"js/7.build.js?03abd444","sourcesContent":["webpackJsonp([7],{\n\n/***/ 112:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nvar initData = function initData() {\n    return {\n        data: {\n            treeView: []\n        },\n        config: {\n            deptNameVal: '', // 部门名称输入框值\n            searchBox: {\n                searchVal: '',\n                placeholder: '权限名称',\n                suggest: {\n                    isShow: 1,\n                    data: []\n                }\n            },\n            treeView: {\n                isShow: 1,\n                isShowIcon: 2,\n                showChoice: true,\n                choiceConfig: {\n                    choiceChild: true\n                },\n                keyConfig: {\n                    name: 'MenuName',\n                    id: 'MenuCode',\n                    childKey: 'ChildList'\n                },\n                locationConfig: {\n                    key: 'id'\n                }\n            },\n            modalBox: {\n                isShow: false,\n                content: '',\n                btn: [{\n                    text: '确定',\n                    handel: 'confirmClick'\n                }, {\n                    text: '取消',\n                    handel: 'cancelClick'\n                }]\n            }\n        }\n    };\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    data: function data() {\n        return new initData();\n    },\n\n    activated: function activated() {\n        var self = this;\n        Bestone.ui.pageInit({\n            setTitle: '权限管理部门配置',\n            reviewCallBack: function reviewCallBack() {\n                self.config.deptNameVal = Bestone.util.query().RoleName || '';\n                // 按关键字获取全部菜单\n                Bestone.util.ajax({\n                    url: 'api/AuthManage/GetAllMenus',\n                    data: JSON.stringify({\n                        Keyword: ''\n                    }),\n                    success: function success(ajaxData) {\n                        self.config.searchBox.suggest.data = Bestone.util.getTreeViewDataForSearch({\n                            data: ajaxData.data || [],\n                            name: 'MenuName',\n                            id: 'MenuCode',\n                            childKey: 'ChildList'\n                        });\n                        self.data.treeView = ajaxData.data || [];\n\n                        // 获取指定权限管理部门下的所有菜单\n                        if (!!Bestone.util.query().RoleId || Bestone.util.query().RoleId === 0) {\n                            Bestone.util.ajax({\n                                url: 'api/AuthManage/GetRoleMenus',\n                                data: JSON.stringify({\n                                    RoleId: Bestone.util.query().RoleId\n                                }),\n                                success: function success(ajaxData) {\n                                    var activeMenuCodes = [];\n                                    // 循环选中的\n                                    $.each(ajaxData.data, function (k, v) {\n                                        $.each(v.ChildList, function (key, value) {\n                                            activeMenuCodes.push(value.MenuCode);\n                                        });\n                                    });\n                                    // 循环树\n                                    $.each(self.data.treeView, function (k, v) {\n                                        $.each(v.ChildList, function (key, value) {\n                                            if (activeMenuCodes.indexOf(value.MenuCode) >= 0) {\n                                                var thisItem = value;\n                                                thisItem.frontActive = 1;\n                                                self.data.treeView[k].ChildList.splice(key, 1, thisItem);\n                                            }\n                                        });\n                                    });\n                                }\n                            });\n                        }\n                    }\n                });\n            }\n        });\n\n        Bestone.ui.ddSetRight({\n            control: true,\n            text: '保存',\n            show: true,\n            onSuccess: function onSuccess() {\n                self.submitConfig();\n            }\n        });\n    },\n    deactivated: function deactivated() {\n        var self = this;\n        // 回退时清除数据\n        Bestone.util.resetData(function () {\n            self.data = initData().data;\n            self.config = initData().config;\n        });\n    },\n    methods: {\n        // 提交配置\n        submitConfig: function submitConfig() {\n            var self = this;\n\n            if (self.config.deptNameVal.length <= 0) {\n                Bestone.ui.message({\n                    content: '部门名称不能为空'\n                });\n                return;\n            }\n\n            var menuCodes = '';\n            $.each(self.data.treeView, function (k, v) {\n                $.each(v.ChildList, function (key, value) {\n                    if (!!value.frontActive && value.frontActive === 1) {\n                        menuCodes = menuCodes + value.MenuCode + ',';\n                    }\n                });\n            });\n            if (menuCodes.length <= 0) {\n                Bestone.ui.message({\n                    content: '请至少选择一个权限'\n                });\n                return;\n            }\n\n            self.config.modalBox.content = '<p style=\"font-size: 14px;text-align: center;padding: 20px 0px;line-height: 16px;\">确定保存配置？</p>';\n            self.config.modalBox.isShow = true;\n        },\n        // 弹出框确认\n        confirmClickDeal: function confirmClickDeal() {\n            var self = this;\n\n            if (self.config.deptNameVal.length <= 0) {\n                Bestone.ui.message({\n                    content: '部门名称不能为空'\n                });\n                return;\n            }\n\n            var menuCodes = '';\n            $.each(self.data.treeView, function (k, v) {\n                $.each(v.ChildList, function (key, value) {\n                    if (!!value.frontActive && value.frontActive === 1) {\n                        menuCodes = menuCodes + value.MenuCode + ',';\n                    }\n                });\n            });\n            if (menuCodes.length <= 0) {\n                Bestone.ui.message({\n                    content: '请至少选择一个权限'\n                });\n                return;\n            }\n            menuCodes = menuCodes.substring(0, menuCodes.length - 1); // 去掉最后一个逗号\n\n            if (!!Bestone.util.query().RoleId || Bestone.util.query().RoleId === 0) {\n                // 更新\n                Bestone.util.ajax({\n                    url: 'api/AuthManage/UpdateRole',\n                    data: JSON.stringify({\n                        Id: Bestone.util.query().RoleId,\n                        RoleName: self.config.deptNameVal,\n                        MenuCodes: menuCodes,\n                        OperId: Bestone.user.id,\n                        OperName: Bestone.user.name\n                    }),\n                    success: function success(ajaxData) {\n                        Bestone.ui.message({\n                            content: '配置成功',\n                            notOper: true\n                        });\n                        self.config.modalBox.isShow = false;\n                        setTimeout(function () {\n                            window.app.$router.go(-1);\n                        }, 1000);\n                    }\n                });\n            } else {\n                // 新增\n                Bestone.util.ajax({\n                    url: 'api/AuthManage/AddRole',\n                    data: JSON.stringify({\n                        RoleName: self.config.deptNameVal,\n                        MenuCodes: menuCodes,\n                        OperId: Bestone.user.id,\n                        OperName: Bestone.user.name\n                    }),\n                    success: function success(ajaxData) {\n                        Bestone.ui.message({\n                            content: '配置成功',\n                            notOper: true\n                        });\n                        self.config.modalBox.isShow = false;\n                        setTimeout(function () {\n                            window.app.$router.go(-1);\n                        }, 1000);\n                    }\n                });\n            }\n        },\n        // 弹出框取消\n        cancelClickDeal: function cancelClickDeal() {\n            var self = this;\n            self.config.modalBox.isShow = false;\n        },\n        // 搜索点击\n        searchClickDeal: function searchClickDeal(str) {\n            Bestone.ui.message({\n                content: '仅支持智能匹配搜索'\n            });\n        },\n        // 输入框值改变\n        searchValChangeDeal: function searchValChangeDeal(str) {\n            this.config.searchBox.searchVal = str; // 必须，用于父子组件数据双向绑定\n        },\n        // 搜索下拉框点击\n        itemClickDeal: function itemClickDeal(item) {\n            var val = item.id;\n            if (!!val) {\n                var $loca = $('.ui.tree-view .loca' + val);\n                $('.ui.tree-view .item').css('background-color', 'transparent');\n                if ($loca.length > 0) {\n                    setTimeout(function () {\n                        $loca.css('background-color', '#FFFBE6');\n                        $(window).scrollTop($loca.offset().top - 5);\n                    }, 100);\n                }\n            }\n        },\n        // 树形列表数据双向绑定\n        dataArrChangeDeal: function dataArrChangeDeal(arr) {\n            var self = this;\n            self.data.treeView = arr;\n        }\n    }\n});\n\n/***/ }),\n\n/***/ 131:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(0)(undefined);\n// imports\n\n\n// module\nexports.push([module.i, \"#dept-config-detail[data-v-4c04245f]{padding-top:10px;padding-bottom:10px}#dept-config-detail>.dept-name[data-v-4c04245f]{padding:5px 15px;background-color:#fff}#dept-config-detail>.search-content[data-v-4c04245f]{border-top:1px solid #eee;background-color:#fff;padding:10px 15px}#dept-config-detail>.tree-view-content[data-v-4c04245f]{margin-top:10px;border-bottom:1px solid #eee}\", \"\"]);\n\n// exports\n\n\n/***/ }),\n\n/***/ 164:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('div', {\n    attrs: {\n      \"id\": \"dept-config-detail\"\n    }\n  }, [_c('div', {\n    staticClass: \"dept-name\"\n  }, [_c('div', {\n    staticClass: \"ui ui-input\"\n  }, [_c('input', {\n    directives: [{\n      name: \"model\",\n      rawName: \"v-model\",\n      value: (_vm.config.deptNameVal),\n      expression: \"config.deptNameVal\"\n    }],\n    attrs: {\n      \"type\": \"text\",\n      \"placeholder\": \"填写部门名称\",\n      \"name\": \"deptName\"\n    },\n    domProps: {\n      \"value\": (_vm.config.deptNameVal)\n    },\n    on: {\n      \"input\": function($event) {\n        if ($event.target.composing) { return; }\n        _vm.config.deptNameVal = $event.target.value\n      }\n    }\n  })])]), _vm._v(\" \"), (_vm.config.selectChoiceId !== '') ? _c('div', {\n    staticClass: \"search-content\"\n  }, [_c('search-box', {\n    attrs: {\n      \"searchVal\": _vm.config.searchBox.searchVal,\n      \"placeholder\": _vm.config.searchBox.placeholder,\n      \"suggest\": _vm.config.searchBox.suggest\n    },\n    on: {\n      \"searchClick\": _vm.searchClickDeal,\n      \"searchValChange\": _vm.searchValChangeDeal,\n      \"itemClick\": _vm.itemClickDeal\n    }\n  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.config.selectChoiceId !== '') ? _c('div', {\n    staticClass: \"tree-view-content\"\n  }, [_c('tree-view', {\n    attrs: {\n      \"dataArr\": _vm.data.treeView,\n      \"setConfig\": _vm.config.treeView\n    },\n    on: {\n      \"dataArrChange\": _vm.dataArrChangeDeal\n    }\n  })], 1) : _vm._e(), _vm._v(\" \"), (false) ? _c('div', {\n    staticClass: \"ui ui-bottom-btn\"\n  }, [_c('v-touch', {\n    staticClass: \"btn\",\n    attrs: {\n      \"tag\": \"div\"\n    },\n    on: {\n      \"pressup\": function($event) {\n        $event.preventDefault();\n        _vm.submitConfig($event)\n      },\n      \"tap\": function($event) {\n        $event.preventDefault();\n        _vm.submitConfig($event)\n      }\n    }\n  }, [_vm._v(\"保存配置\")])], 1) : _vm._e(), _vm._v(\" \"), _c('modal-box', {\n    attrs: {\n      \"setConfig\": _vm.config.modalBox\n    },\n    on: {\n      \"confirmClick\": _vm.confirmClickDeal,\n      \"cancelClick\": _vm.cancelClickDeal\n    }\n  })], 1)])\n},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 195:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(131);\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(2)(\"b673d38a\", content, true);\n\n/***/ }),\n\n/***/ 81:\n/***/ (function(module, exports, __webpack_require__) {\n\nfunction injectStyle (ssrContext) {\n  __webpack_require__(195)\n}\nvar Component = __webpack_require__(1)(\n  /* script */\n  __webpack_require__(112),\n  /* template */\n  __webpack_require__(164),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-4c04245f\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// js/7.build.js?03abd444","<!-- 权限管理配置-部门配置-详细 -->\r\n<template>\r\n    <div>\r\n        <div id=\"dept-config-detail\">\r\n            <div class=\"dept-name\">\r\n                <div class=\"ui ui-input\"><input type=\"text\" v-model=\"config.deptNameVal\" placeholder=\"填写部门名称\" name=\"deptName\"/></div>\r\n            </div>\r\n            <div class=\"search-content\" v-if=\"config.selectChoiceId !== ''\">\r\n                <search-box :searchVal=\"config.searchBox.searchVal\" :placeholder=\"config.searchBox.placeholder\" :suggest=\"config.searchBox.suggest\" @searchClick=\"searchClickDeal\" @searchValChange=\"searchValChangeDeal\" @itemClick=\"itemClickDeal\"></search-box>\r\n            </div>\r\n            <div class=\"tree-view-content\" v-if=\"config.selectChoiceId !== ''\">\r\n                <tree-view :dataArr=\"data.treeView\" :setConfig=\"config.treeView\" @dataArrChange=\"dataArrChangeDeal\"></tree-view>\r\n            </div>\r\n            <div class=\"ui ui-bottom-btn\" v-if=\"false\">\r\n                <v-touch tag=\"div\" class=\"btn\" @pressup.prevent=\"submitConfig\" @tap.prevent=\"submitConfig\">保存配置</v-touch>\r\n            </div>\r\n            <!-- 对话框 -->\r\n            <modal-box :setConfig=\"config.modalBox\" @confirmClick=\"confirmClickDeal\" @cancelClick=\"cancelClickDeal\"></modal-box>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script scoped>\r\n    var initData = function () {\r\n        return {\r\n            data: {\r\n                treeView: []\r\n            },\r\n            config: {\r\n                deptNameVal: '', // 部门名称输入框值\r\n                searchBox: {\r\n                    searchVal: '',\r\n                    placeholder: '权限名称',\r\n                    suggest: {\r\n                        isShow: 1,\r\n                        data: [],\r\n                    }\r\n                },\r\n                treeView: {\r\n                    isShow: 1,\r\n                    isShowIcon: 2,\r\n                    showChoice: true,\r\n                    choiceConfig: {\r\n                        choiceChild: true\r\n                    },\r\n                    keyConfig: {\r\n                        name: 'MenuName',\r\n                        id: 'MenuCode',\r\n                        childKey: 'ChildList'\r\n                    },\r\n                    locationConfig: {\r\n                        key: 'id'\r\n                    }\r\n                },\r\n                modalBox: {\r\n                    isShow: false,\r\n                    content: '',\r\n                    btn: [{\r\n                        text: '确定',\r\n                        handel: 'confirmClick'\r\n                    }, {\r\n                        text: '取消',\r\n                        handel: 'cancelClick'\r\n                    }]\r\n                }\r\n            }\r\n        }\r\n    };\r\n    export default {\r\n        data() {\r\n            return new initData()\r\n        },\r\n        activated: function () {\r\n            let self = this;\r\n            Bestone.ui.pageInit({\r\n                setTitle: '权限管理部门配置',\r\n                reviewCallBack: function () {\r\n                    self.config.deptNameVal = Bestone.util.query().RoleName || '';\r\n                    // 按关键字获取全部菜单\r\n                    Bestone.util.ajax({\r\n                        url: 'api/AuthManage/GetAllMenus',\r\n                        data: JSON.stringify({\r\n                            Keyword: ''\r\n                        }),\r\n                        success: function (ajaxData) {\r\n                            self.config.searchBox.suggest.data = Bestone.util.getTreeViewDataForSearch({\r\n                                data: ajaxData.data || [],\r\n                                name: 'MenuName',\r\n                                id: 'MenuCode',\r\n                                childKey: 'ChildList'\r\n                            });\r\n                            self.data.treeView = ajaxData.data || [];\r\n\r\n                            // 获取指定权限管理部门下的所有菜单\r\n                            if(!!Bestone.util.query().RoleId || Bestone.util.query().RoleId===0) {\r\n                                Bestone.util.ajax({\r\n                                    url: 'api/AuthManage/GetRoleMenus',\r\n                                    data: JSON.stringify({\r\n                                        RoleId: Bestone.util.query().RoleId\r\n                                    }),\r\n                                    success: function (ajaxData) {\r\n                                        var activeMenuCodes = [];\r\n                                        // 循环选中的\r\n                                        $.each(ajaxData.data, function (k, v) {\r\n                                            $.each(v.ChildList, function (key,value) {\r\n                                                activeMenuCodes.push(value.MenuCode);\r\n                                            });\r\n                                        });\r\n                                        // 循环树\r\n                                        $.each(self.data.treeView, function (k, v) {\r\n                                            $.each(v.ChildList, function (key,value) {\r\n                                                if(activeMenuCodes.indexOf(value.MenuCode) >= 0) {\r\n                                                    var thisItem = value;\r\n                                                    thisItem.frontActive = 1;\r\n                                                    self.data.treeView[k].ChildList.splice(key,1,thisItem);\r\n                                                }\r\n                                            });\r\n                                        });\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            Bestone.ui.ddSetRight({\r\n                control: true,\r\n                text: '保存',\r\n                show: true,\r\n                onSuccess: function () {\r\n                    self.submitConfig();\r\n                }\r\n            });\r\n        },\r\n        deactivated: function () {\r\n            var self = this;\r\n            // 回退时清除数据\r\n            Bestone.util.resetData(function () {\r\n                self.data = initData().data;\r\n                self.config = initData().config;\r\n            });\r\n        },\r\n        methods: {\r\n            // 提交配置\r\n            submitConfig: function () {\r\n                let self = this;\r\n\r\n                if (self.config.deptNameVal.length <= 0) {\r\n                    Bestone.ui.message({\r\n                        content: '部门名称不能为空'\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                var menuCodes = '';\r\n                $.each(self.data.treeView, function (k, v) {\r\n                    $.each(v.ChildList, function (key,value) {\r\n                        if (!!value.frontActive && value.frontActive===1) {\r\n                            menuCodes = menuCodes + value.MenuCode + ',';\r\n                        }\r\n                    });\r\n                });\r\n                if (menuCodes.length <= 0) {\r\n                    Bestone.ui.message({\r\n                        content: '请至少选择一个权限'\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                self.config.modalBox.content = '<p style=\"font-size: 14px;text-align: center;padding: 20px 0px;line-height: 16px;\">确定保存配置？</p>';\r\n                self.config.modalBox.isShow = true;\r\n            },\r\n            // 弹出框确认\r\n            confirmClickDeal: function () {\r\n                let self = this;\r\n\r\n                if (self.config.deptNameVal.length <= 0) {\r\n                    Bestone.ui.message({\r\n                        content: '部门名称不能为空'\r\n                    });\r\n                    return;\r\n                }\r\n\r\n                var menuCodes = '';\r\n                $.each(self.data.treeView, function (k, v) {\r\n                    $.each(v.ChildList, function (key,value) {\r\n                        if (!!value.frontActive && value.frontActive===1) {\r\n                            menuCodes = menuCodes + value.MenuCode + ',';\r\n                        }\r\n                    });\r\n                });\r\n                if (menuCodes.length <= 0) {\r\n                    Bestone.ui.message({\r\n                        content: '请至少选择一个权限'\r\n                    });\r\n                    return;\r\n                }\r\n                menuCodes = menuCodes.substring(0,menuCodes.length-1); // 去掉最后一个逗号\r\n\r\n                if(!!Bestone.util.query().RoleId || Bestone.util.query().RoleId===0) { // 更新\r\n                    Bestone.util.ajax({\r\n                        url: 'api/AuthManage/UpdateRole',\r\n                        data: JSON.stringify({\r\n                            Id: Bestone.util.query().RoleId,\r\n                            RoleName: self.config.deptNameVal,\r\n                            MenuCodes: menuCodes,\r\n                            OperId: Bestone.user.id,\r\n                            OperName: Bestone.user.name\r\n                        }),\r\n                        success: function (ajaxData) {\r\n                            Bestone.ui.message({\r\n                                content: '配置成功',\r\n                                notOper: true\r\n                            });\r\n                            self.config.modalBox.isShow = false;\r\n                            setTimeout(function () {\r\n                                window.app.$router.go(-1);\r\n                            }, 1000);\r\n                        }\r\n                    });\r\n                }else { // 新增\r\n                    Bestone.util.ajax({\r\n                        url: 'api/AuthManage/AddRole',\r\n                        data: JSON.stringify({\r\n                            RoleName: self.config.deptNameVal,\r\n                            MenuCodes: menuCodes,\r\n                            OperId: Bestone.user.id,\r\n                            OperName: Bestone.user.name\r\n                        }),\r\n                        success: function (ajaxData) {\r\n                            Bestone.ui.message({\r\n                                content: '配置成功',\r\n                                notOper: true\r\n                            });\r\n                            self.config.modalBox.isShow = false;\r\n                            setTimeout(function () {\r\n                                window.app.$router.go(-1);\r\n                            }, 1000);\r\n                        }\r\n                    });\r\n                }\r\n            },\r\n            // 弹出框取消\r\n            cancelClickDeal: function () {\r\n                let self = this;\r\n                self.config.modalBox.isShow = false;\r\n            },\r\n            // 搜索点击\r\n            searchClickDeal: function (str) {\r\n                Bestone.ui.message({\r\n                    content: '仅支持智能匹配搜索'\r\n                });\r\n            },\r\n            // 输入框值改变\r\n            searchValChangeDeal: function (str) {\r\n                this.config.searchBox.searchVal = str; // 必须，用于父子组件数据双向绑定\r\n            },\r\n            // 搜索下拉框点击\r\n            itemClickDeal: function (item) {\r\n                let val = item.id;\r\n                if (!!val) {\r\n                    let $loca = $('.ui.tree-view .loca' + val);\r\n                    $('.ui.tree-view .item').css('background-color', 'transparent');\r\n                    if ($loca.length > 0) {\r\n                        setTimeout(function () {\r\n                            $loca.css('background-color', '#FFFBE6');\r\n                            $(window).scrollTop($loca.offset().top - 5);\r\n                        }, 100);\r\n                    }\r\n                }\r\n            },\r\n            // 树形列表数据双向绑定\r\n            dataArrChangeDeal: function (arr) {\r\n                let self = this;\r\n                self.data.treeView = arr;\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    #dept-config-detail {\r\n        padding-top: 10px;\r\n        padding-bottom: 10px;\r\n        & > .dept-name {\r\n            padding: 5px 15px;\r\n            background-color: #fff;\r\n        }\r\n        & > .search-content {\r\n            border-top: solid 1px #eee;\r\n            background-color: #fff;\r\n            padding: 10px 15px;\r\n        }\r\n        & > .tree-view-content {\r\n            margin-top: 10px;\r\n            border-bottom: solid 1px #eee;\r\n        }\r\n    }\r\n</style>\n\n\n// WEBPACK FOOTER //\n// deptConfigDetail.vue?40ec1c38","exports = module.exports = require(\"../../../node_modules/_css-loader@0.28.7@css-loader/lib/css-base.js\")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, \"#dept-config-detail[data-v-4c04245f]{padding-top:10px;padding-bottom:10px}#dept-config-detail>.dept-name[data-v-4c04245f]{padding:5px 15px;background-color:#fff}#dept-config-detail>.search-content[data-v-4c04245f]{border-top:1px solid #eee;background-color:#fff;padding:10px 15px}#dept-config-detail>.tree-view-content[data-v-4c04245f]{margin-top:10px;border-bottom:1px solid #eee}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_css-loader@0.28.7@css-loader?minimize!./~/_vue-loader@12.2.2@vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-4c04245f\",\"scoped\":true,\"hasInlineConfig\":true}!./~/_sass-loader@6.0.6@sass-loader/lib/loader.js!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!./src/component/permissionMgmtConfig/deptConfigDetail.vue\n// module id = 131\n// module chunks = 7","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('div', {\n    attrs: {\n      \"id\": \"dept-config-detail\"\n    }\n  }, [_c('div', {\n    staticClass: \"dept-name\"\n  }, [_c('div', {\n    staticClass: \"ui ui-input\"\n  }, [_c('input', {\n    directives: [{\n      name: \"model\",\n      rawName: \"v-model\",\n      value: (_vm.config.deptNameVal),\n      expression: \"config.deptNameVal\"\n    }],\n    attrs: {\n      \"type\": \"text\",\n      \"placeholder\": \"填写部门名称\",\n      \"name\": \"deptName\"\n    },\n    domProps: {\n      \"value\": (_vm.config.deptNameVal)\n    },\n    on: {\n      \"input\": function($event) {\n        if ($event.target.composing) { return; }\n        _vm.config.deptNameVal = $event.target.value\n      }\n    }\n  })])]), _vm._v(\" \"), (_vm.config.selectChoiceId !== '') ? _c('div', {\n    staticClass: \"search-content\"\n  }, [_c('search-box', {\n    attrs: {\n      \"searchVal\": _vm.config.searchBox.searchVal,\n      \"placeholder\": _vm.config.searchBox.placeholder,\n      \"suggest\": _vm.config.searchBox.suggest\n    },\n    on: {\n      \"searchClick\": _vm.searchClickDeal,\n      \"searchValChange\": _vm.searchValChangeDeal,\n      \"itemClick\": _vm.itemClickDeal\n    }\n  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.config.selectChoiceId !== '') ? _c('div', {\n    staticClass: \"tree-view-content\"\n  }, [_c('tree-view', {\n    attrs: {\n      \"dataArr\": _vm.data.treeView,\n      \"setConfig\": _vm.config.treeView\n    },\n    on: {\n      \"dataArrChange\": _vm.dataArrChangeDeal\n    }\n  })], 1) : _vm._e(), _vm._v(\" \"), (false) ? _c('div', {\n    staticClass: \"ui ui-bottom-btn\"\n  }, [_c('v-touch', {\n    staticClass: \"btn\",\n    attrs: {\n      \"tag\": \"div\"\n    },\n    on: {\n      \"pressup\": function($event) {\n        $event.preventDefault();\n        _vm.submitConfig($event)\n      },\n      \"tap\": function($event) {\n        $event.preventDefault();\n        _vm.submitConfig($event)\n      }\n    }\n  }, [_vm._v(\"保存配置\")])], 1) : _vm._e(), _vm._v(\" \"), _c('modal-box', {\n    attrs: {\n      \"setConfig\": _vm.config.modalBox\n    },\n    on: {\n      \"confirmClick\": _vm.confirmClickDeal,\n      \"cancelClick\": _vm.cancelClickDeal\n    }\n  })], 1)])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_vue-loader@12.2.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-4c04245f\",\"hasScoped\":true}!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=template&index=0!./src/component/permissionMgmtConfig/deptConfigDetail.vue\n// module id = 164\n// module chunks = 7","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/_css-loader@0.28.7@css-loader/index.js?minimize!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4c04245f\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":true}!../../../node_modules/_sass-loader@6.0.6@sass-loader/lib/loader.js!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!./deptConfigDetail.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/_vue-style-loader@3.0.1@vue-style-loader/lib/addStylesClient.js\")(\"b673d38a\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_vue-style-loader@3.0.1@vue-style-loader!./~/_css-loader@0.28.7@css-loader?minimize!./~/_vue-loader@12.2.2@vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-4c04245f\",\"scoped\":true,\"hasInlineConfig\":true}!./~/_sass-loader@6.0.6@sass-loader/lib/loader.js!./~/_vue-loader@12.2.2@vue-loader/lib/selector.js?type=styles&index=0!./src/component/permissionMgmtConfig/deptConfigDetail.vue\n// module id = 195\n// module chunks = 7","function injectStyle (ssrContext) {\n  require(\"!!vue-loader/node_modules/vue-style-loader!css-loader?minimize!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4c04245f\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":true}!sass-loader!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=styles&index=0!./deptConfigDetail.vue\")\n}\nvar Component = require(\"!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=script&index=0!./deptConfigDetail.vue\"),\n  /* template */\n  require(\"!!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4c04245f\\\",\\\"hasScoped\\\":true}!../../../node_modules/_vue-loader@12.2.2@vue-loader/lib/selector?type=template&index=0!./deptConfigDetail.vue\"),\n  /* styles */\n  injectStyle,\n  /* scopeId */\n  \"data-v-4c04245f\",\n  /* moduleIdentifier (server only) */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/component/permissionMgmtConfig/deptConfigDetail.vue\n// module id = 81\n// module chunks = 7"],"sourceRoot":""}