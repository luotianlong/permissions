webpackJsonp([16],{103:function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(){return{data:{treeView:[]},config:{userId:0,userName:"",userUserName:"",userBranchName:"",menuCode:"",menuName:"",clearOneNeedClear:{item:{},index:0},modalBox:{clearAll:{isShow:!1,content:"",btn:[{text:"确定",handel:"confirmClick"},{text:"取消",handel:"cancelClick"}]},clearOne:{isShow:!1,content:"",btn:[{text:"确定",handel:"confirmClick"},{text:"取消",handel:"cancelClick"}]}},searchBox:{searchVal:"",placeholder:"公司名称",suggest:{isShow:1,data:[]}},treeView:{isShow:1,isShowIcon:2,keyConfig:{name:"Branch_Name",id:"Config_ID",childKey:"ChildList"},btn:[{iconFontClass:"icon-shanchu",color:"#FF4141",handle:"clear"}],locationConfig:{key:"id"}}}}};n.default={data:function(){return new t},activated:function(){var e=this;Bestone.ui.pageInit({setTitle:"管理账户权限",reviewCallBack:function(){e.config.userId=parseInt(Bestone.util.query().UserID,10),e.config.userName=Bestone.util.query().UserName||"",e.config.userUserName=Bestone.util.query().UserUserName||"",e.config.userBranchName=Bestone.util.query().UserBranchName||"",e.config.menuCode=Bestone.util.query().MenuCode||"",e.config.menuName=Bestone.util.query().MenuName||"",Bestone.util.ajax({url:"api/UserManage/GetMenuUserConfigByUser",data:JSON.stringify({MenuCode:e.config.menuCode,UserId:e.config.userId,Keyword:e.config.searchBox.searchVal}),success:function(n){e.config.searchBox.suggest.data=Bestone.util.getTreeViewDataForSearch({data:n.data||[],name:"Branch_Name",id:"Config_ID",childKey:"ChildList"}),e.data.treeView=n.data||[]}})}})},deactivated:function(){var e=this;Bestone.util.resetData(function(){e.data=t().data,e.config=t().config})},methods:{clearAll:function(){var e=this;e.config.modalBox.clearAll.content='<p style="font-size: 14px;text-align: center;padding: 20px 0px;line-height: 16px;">确定移除该权限？</p>',e.config.modalBox.clearAll.isShow=!0},clearAllConfirmClickDeal:function(){var e=this;Bestone.util.ajax({url:"api/UserManage/DeleteMenuUserConfigByMenu",data:JSON.stringify({MenuCode:e.config.menuCode,UserId:e.config.userId,OperId:Bestone.user.id,OperName:Bestone.user.name}),success:function(n){Bestone.ui.message({content:"操作成功！",notOper:!0}),setTimeout(function(){e.config.modalBox.clearAll.isShow=!1,window.app.$router.go(-1)},1e3)}})},clearAllCancelClickDeal:function(){this.config.modalBox.clearAll.isShow=!1},itemClickDeal:function(e){var n=e.id;if(n){var a=$(".ui.tree-view .loca"+n);$(".ui.tree-view .item").css("background-color","transparent"),a.length>0&&setTimeout(function(){a.css("background-color","#FFFBE6"),$(window).scrollTop(a.offset().top-5)},100)}},searchClickDeal:function(e){Bestone.ui.message({content:"仅支持智能匹配搜索"})},searchValChangeDeal:function(e){this.config.searchBox.searchVal=e,console.log(e)},clearDeal:function(e,n){var a=this;a.config.clearOneNeedClear.item=e,a.config.clearOneNeedClear.index=n,a.config.modalBox.clearOne.content='<p style="font-size: 14px;text-align: center;padding: 20px 0px;line-height: 16px;">确定移除'+e.Branch_Name+"？</p>",a.config.modalBox.clearOne.isShow=!0},clearOneConfirmClickDeal:function(){var e=this;Bestone.util.ajax({url:"api/UserManage/DeleteMenuUserConfigById",data:JSON.stringify({ConfigId:e.config.clearOneNeedClear.item.Config_ID,UserId:e.config.userId,OperId:Bestone.user.id,OperName:Bestone.user.name}),success:function(n){Bestone.ui.message({content:"操作成功！",notOper:!0}),e.config.modalBox.clearOne.isShow=!1,e.data.treeView.splice(e.config.clearOneNeedClear.index,1),0===e.data.treeView.length&&setTimeout(function(){window.app.$router.go(-1)},1e3)}})},clearOneCancelClickDeal:function(){this.config.modalBox.clearOne.isShow=!1}}}},139:function(e,n,a){n=e.exports=a(0)(void 0),n.push([e.i,"#permission-mgmt[data-v-9eb68850]{padding-top:10px;padding-bottom:10px}#permission-mgmt>.search-content[data-v-9eb68850]{border-top:1px solid #eee;background-color:#fff;padding:10px 15px}#permission-mgmt>.ui-title[data-v-9eb68850]{margin-top:10px}#permission-mgmt>.tree-view-content[data-v-9eb68850]{border-bottom:1px solid #eee}",""])},172:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("div",[a("div",{attrs:{id:"permission-mgmt"}},[a("div",{staticClass:"ui ui-text-list"},[a("p",[e._v("TDS账号："+e._s(e.config.userName))]),e._v(" "),a("p",[e._v("姓名："+e._s(e.config.userUserName))]),e._v(" "),a("p",[e._v("账号所属公司："+e._s(e.config.userBranchName))])]),e._v(" "),a("div",{staticClass:"search-content"},[a("search-box",{attrs:{searchVal:e.config.searchBox.searchVal,placeholder:e.config.searchBox.placeholder,suggest:e.config.searchBox.suggest},on:{searchClick:e.searchClickDeal,searchValChange:e.searchValChangeDeal,itemClick:e.itemClickDeal}})],1),e._v(" "),a("div",{staticClass:"ui ui-title"},[a("p",{staticClass:"omit",staticStyle:{width:"65%"}},[e._v(e._s(e.config.menuName)+"权限管理范围")]),e._v(" "),a("v-touch",{staticClass:"right-btn bg-btn bg-red",attrs:{tag:"a"},on:{pressup:function(n){n.preventDefault(),e.clearAll(n)},tap:function(n){n.preventDefault(),e.clearAll(n)}}},[e._v("移除该权限")])],1),e._v(" "),a("div",{staticClass:"tree-view-content"},[a("tree-view",{attrs:{dataArr:e.data.treeView,setConfig:e.config.treeView},on:{clear:e.clearDeal}})],1),e._v(" "),e.data.treeView&&e.data.treeView.length<=0?a("div",{staticClass:"ui no-data"},[e._v("暂无数据")]):e._e(),e._v(" "),e._e(),e._v(" "),a("modal-box",{attrs:{setConfig:e.config.modalBox.clearAll},on:{confirmClick:e.clearAllConfirmClickDeal,cancelClick:e.clearAllCancelClickDeal}}),e._v(" "),a("modal-box",{attrs:{setConfig:e.config.modalBox.clearOne},on:{confirmClick:e.clearOneConfirmClickDeal,cancelClick:e.clearOneCancelClickDeal}})],1)])},staticRenderFns:[]}},203:function(e,n,a){var t=a(139);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);a(2)("4dd8c692",t,!0)},72:function(e,n,a){function t(e){a(203)}var i=a(1)(a(103),a(172),t,"data-v-9eb68850",null);e.exports=i.exports}});