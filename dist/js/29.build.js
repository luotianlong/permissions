webpackJsonp([29],{131:function(t,e,i){e=t.exports=i(0)(void 0),e.push([t.i,"#audit-detail[data-v-535008d1]{padding-top:10px;padding-bottom:0}#audit-detail>.apply-info[data-v-535008d1]{overflow:hidden}#audit-detail>.ui.ui-title[data-v-535008d1]{margin-top:10px}#audit-detail>.audit-records[data-v-535008d1]{background-color:#fff;padding:10px 15px}#audit-detail>.audit-records>.ui.ui-table[data-v-535008d1]{margin-bottom:10px}#audit-detail>.audit-records>.ui.ui-table[data-v-535008d1]:last-child{margin-bottom:0}#audit-detail>.apply-list[data-v-535008d1]{background-color:#fff;padding:10px 15px}#audit-detail>.instruction-content[data-v-535008d1]{padding:10px 15px;color:#666;line-height:18px;background-color:#fff;border-bottom:1px solid #eee}#audit-detail>.radio-choice[data-v-535008d1]{padding:10px 15px;background-color:#fff;border-bottom:1px solid #eee;min-height:20px;font-size:0;overflow:hidden}#audit-detail>.radio-choice>.ui.ui-radio[data-v-535008d1]{margin-right:70px;float:left}#audit-detail>.radio-choice>.ui.ui-radio[data-v-535008d1]:last-child{margin-right:0}#audit-detail>.audit-opinion[data-v-535008d1]{padding:10px 15px;background-color:#fff;margin-bottom:10px}",""])},164:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.config.isShowPage?i("div",{attrs:{id:"audit-detail"}},[i("div",{staticClass:"ui ui-text-list apply-info"},[t.config.applyInfo.ProxyApplyUserName?t._e():i("p",[t._v("申请人："+t._s(t.config.applyInfo.ApplyUserName))]),t._v(" "),t.config.applyInfo.ProxyApplyUserName?i("p",[t._v("代办人："+t._s(t.config.applyInfo.ApplyUserName))]):t._e(),t._v(" "),i("p",[t._v("申请时间："+t._s(t.config.applyInfo.ApplyDate?t.config.applyInfo.ApplyDate.split(" ")[0]:""))]),t._v(" "),(t.config.applyInfo.ProxyApplyUserAccount,t._e()),t._v(" "),t.config.applyInfo.ProxyApplyUserName?i("p",[t._v("申请人："+t._s(t.config.applyInfo.ProxyApplyUserName))]):t._e()]),t._v(" "),t.config.auditData.length>0?i("div",{staticClass:"ui ui-title"},[t._v("审核记录")]):t._e(),t._v(" "),t.config.auditData.length>0?i("div",{staticClass:"audit-records"},[t._l(t.config.auditData,function(e,a){return i("div",{staticClass:"ui ui-table"},[i("table",[i("col",{attrs:{width:"33.333%"}}),t._v(" "),i("col",{attrs:{width:"33.333%"}}),t._v(" "),i("col",{attrs:{width:"33.333%"}}),t._v(" "),i("thead",[i("tr",[i("th",[t._v(t._s(100==e.ExaminStatus?"1":"2")+"级审核人")]),t._v(" "),i("th",[t._v("审核时间")]),t._v(" "),i("th",[t._v("审核状态")])])]),t._v(" "),i("tbody",[i("tr",[i("td",[t._v(t._s(t.textStatusDeal(e.ExaminUser)))]),t._v(" "),i("td",[t._v(t._s(e.ExamineDate.split(" ")[0]))]),t._v(" "),i("td",[t._v(t._s(t.renderExaminStatus(e)))])]),t._v(" "),i("tr",[i("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"3"}},[t._v("审核说明："+t._s(e.ExamineRemark?e.ExamineRemark:"无"))])])])])])}),t._v(" "),t.config.auditData.length<=0?i("div",{staticClass:"ui no-data",staticStyle:{"margin-top":"0px"}},[t._v("暂无数据")]):t._e()],2):t._e(),t._v(" "),i("div",{staticClass:"ui ui-title"},[t._v("申请权限列表")]),t._v(" "),i("div",{staticClass:"apply-list"},[i("div",{staticClass:"ui ui-table"},[i("table",[i("col",{attrs:{width:"33.333%"}}),t._v(" "),i("col",{attrs:{width:"33.333%"}}),t._v(" "),i("col",{attrs:{width:"33.333%"}}),t._v(" "),t._m(0),t._v(" "),i("tbody",t._l(t.config.applyList,function(e,a){return i("tr",[i("td",[t._v(t._s(e.MenuName))]),t._v(" "),t.strToArr(e.Branchs).length>1?i("td",[i("v-touch",{attrs:{tag:"p"},on:{tap:function(i){i.preventDefault(),t.viewControlLimit(e.Branchs)},pressup:function(i){i.preventDefault(),t.viewControlLimit(e.Branchs)}}},[t._v(t._s(t.textStatusDeal(e.Branchs))),i("i",{staticClass:"iconfont icon-gengduo"})])],1):t._e(),t._v(" "),t.strToArr(e.Branchs).length<=1?i("td",[i("p",[t._v(t._s(t.textStatusDeal(e.Branchs)))])]):t._e(),t._v(" "),i("td",[t._v(t._s(t.renderButton(e.Buttons)))])])}))])])]),t._v(" "),i("div",{staticClass:"ui ui-title"},[t._v("申请权限说明")]),t._v(" "),i("div",{staticClass:"instruction-content"},[t._v(t._s(t.config.applyInfo.ApplyDesc||"无"))]),t._v(" "),i("div",{staticClass:"radio-choice"},[i("v-touch",{staticClass:"ui ui-radio",class:t.checkRadioClass(1),attrs:{tag:"div"},on:{tap:function(e){e.preventDefault(),t.clickRadio(1)},pressup:function(e){e.preventDefault(),t.clickRadio(1)}}},[i("i"),i("span",[t._v("同意")])]),t._v(" "),i("v-touch",{staticClass:"ui ui-radio",class:t.checkRadioClass(2),attrs:{tag:"div"},on:{tap:function(e){e.preventDefault(),t.clickRadio(2)},pressup:function(e){e.preventDefault(),t.clickRadio(2)}}},[i("i"),i("span",[t._v("不同意")])])],1),t._v(" "),i("div",{staticClass:"audit-opinion"},[i("div",{staticClass:"ui ui-textarea"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.config.remark,expression:"config.remark"}],attrs:{placeholder:"审核意见（选填）"},domProps:{value:t.config.remark},on:{input:function(e){e.target.composing||(t.config.remark=e.target.value)}}})])]),t._v(" "),t._e(),t._v(" "),i("modal-box",{attrs:{setConfig:t.config.modalBox},on:{confirmClick:t.confirmClickDeal,cancelClick:t.cancelClickDeal}})],1):t._e()])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("th",[t._v("申请权限名称")]),t._v(" "),i("th",[t._v("管理范围")]),t._v(" "),i("th",[t._v("导出权限")])])])}]}},195:function(t,e,i){var a=i(131);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i(2)("0852161d",a,!0)},58:function(t,e,i){function a(t){i(195)}var n=i(1)(i(89),i(164),a,"data-v-535008d1",null);t.exports=n.exports},89:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){return{data:{},config:{isShowPage:!1,source:0,ddAuthCode:"",corpId:0,remark:"",isAgree:1,applyList:[],applyInfo:{},auditData:[],modalBox:{isShow:!1,content:"",btn:[{text:"确定",handel:"confirmClick"},{text:"取消",handel:"cancelClick"}]}}}};e.default={data:function(){return new a},mounted:function(){},activated:function(){var t=this;Bestone.ui.pageInit({setTitle:"审核详情",reviewCallBack:function(){function e(){t.config.isShowPage=!0,Bestone.util.ajax({url:"api/PermissionManage/GetApplyMemuDetails?applyId="+Bestone.util.query().ApplyId,data:JSON.stringify({}),success:function(e){t.config.applyList=e.data}}),Bestone.util.ajax({url:"api/PermissionManage/GetAuthApplyById?applyId="+Bestone.util.query().ApplyId,data:JSON.stringify({}),success:function(e){t.config.applyInfo=e.data}}),Bestone.util.ajax({url:"api/PermissionManage/GetExaminLog?applyId="+Bestone.util.query().ApplyId,data:JSON.stringify({}),success:function(e){var i=[];$.each(e.data,function(t,e){100!=e.ExaminOperStatus&&101!=e.ExaminOperStatus&&i.push(e)}),t.config.auditData=i||[]}})}if(t.config.source=Bestone.util.query().source||0,!dd.version&&!Bestone.util.isDev())return Bestone.ui.message({content:"请在移动端钉钉打开此页面"}),void Bestone.util.vueJump({path:"/404"});if(1==t.config.source){var i=(new Date).getTime();Bestone.ui.loadingFrame({timestamp:i}),Bestone.util.ajax({url:"api/DingTalk/GetDingTalkConfig",showLoad:!1,data:JSON.stringify({url:location.href}),success:function(a){a=a.data,t.config.corpId=a.corpId,dd.config({agentId:a.agentid,corpId:a.corpId,timeStamp:a.timeStamp,nonceStr:a.nonceStr,signature:a.signature,type:0,jsApiList:["runtime.info","biz.contact.choose","device.notification.confirm","device.notification.alert","device.notification.prompt","device.base.getUUID","device.base.getInterface","device.launcher.launchApp","biz.alipay.pay","biz.user.get","biz.util.scan","biz.ding.post","biz.telephone.call","device.notification.modal","biz.chat.openSingleChat","ui.input.plain","ui.progressBar.setColors","biz.navigation.setLeft","runtime.permission.requestAuthCode","device.geolocation.get","biz.chat.pickConversation","biz.ding.post","biz.contact.complexChoose","biz.navigation.setTitle","biz.navigation.setRight"]}),dd.ready(function(){dd.runtime.permission.requestAuthCode({corpId:a.corpId,onSuccess:function(a){Bestone.ui.ddSetRight({control:!0,text:"提交",show:!0,onSuccess:function(){t.submitEvent()}}),t.config.ddAuthCode=a.code,Bestone.util.ajax({url:"api/DingTalk/AuthDingDingBind?dingCode="+a.code,type:"GET",showLoad:!1,success:function(t){t=t.data,Bestone.user.id=t.UserId,Bestone.user.user=t.AccountName,Bestone.user.name=t.UserName,Bestone.user.branchId=t.BranchId,Bestone.user.branchName=t.BranchName,sessionStorage.user=JSON.stringify({id:t.UserId,user:t.AccountName,name:t.UserName,branchId:t.BranchId,branchName:t.BranchName}),Bestone.util.getToken({showLoad:!1,success:function(){Bestone.ui.hideLoadingFrame({timestamp:i}),e()}})},complete:function(t,e){"success"!=e&&Bestone.ui.hideLoadingFrame({timestamp:i})}})},onFail:function(t){Bestone.ui.hideLoadingFrame({timestamp:i}),Bestone.ui.message({content:"获取授权码失败"})}})}),dd.error(function(t){Bestone.ui.hideLoadingFrame({timestamp:i}),Bestone.ui.message({content:JSON.stringify(t)})})},complete:function(t,e){"success"!=e&&Bestone.ui.hideLoadingFrame({timestamp:i})}})}else e()}}),Bestone.ui.ddSetRight({control:!0,text:"提交",show:!0,onSuccess:function(){t.submitEvent()}})},deactivated:function(){var t=this;Bestone.util.resetData(function(){t.$data.data=a().data,t.$data.config=a().config})},methods:{textStatusDeal:function(t){return Bestone.util.textStatusDeal(t)},viewControlLimit:function(t){","===t.substring(t.length-1)&&(t=t.substring(0,t.length-1));var e=t.split(","),i=[];$.each(e,function(t,e){i.push({name:e})}),Bestone.mgmtLimitData=i,Bestone.util.vueJump({path:"/applyRecord/controlLimit"})},renderExaminStatus:function(t){return 100==t.ExaminOperStatus||101==t.ExaminOperStatus?"审核中":Bestone.vars.examinStatus[t.ExaminOperStatus]},checkRadioClass:function(t){return this.config.isAgree==t?"checked":""},clickRadio:function(t){this.config.isAgree=t},submitEvent:function(){var t=this;t.config.modalBox.content='<p style="font-size: 14px;text-align: center;padding: 20px 0px;line-height: 16px;">确定提交？</p>',t.config.modalBox.isShow=!0},confirmClickDeal:function(){var t=this;Bestone.util.ajax({url:"api/PermissionManage/RoleApplyExamine",data:JSON.stringify({ApplyID:parseInt(Bestone.util.query().ApplyId,10),Status:t.config.isAgree,Remark:t.config.remark}),success:function(e){Bestone.ui.message({content:"提交成功",notOper:!0}),1==t.config.source?(t.config.modalBox.content='<p style="font-size: 14px;text-align: center;padding: 20px 0px;line-height: 16px;">提交成功</p>',t.config.modalBox.btn=[],setTimeout(function(){dd.biz.navigation.close({})},1500)):setTimeout(function(){window.app.$router.go(-1)},1e3)}})},cancelClickDeal:function(){this.config.modalBox.isShow=!1},strToArr:function(t){return","===t.substring(t.length-1)&&(t=t.substring(0,t.length-1)),t.split(",")},renderButton:function(t){var e="";if(t.length<=0)e="无";else{","===t.substring(t.length-1)&&(t=t.substring(0,t.length-1));var i=t.split(",");e=i.length>1?i[0]+"等":i[0]}return e}}}}});