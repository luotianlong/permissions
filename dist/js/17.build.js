webpackJsonp([17],{102:function(e,a,n){"use strict";function t(e){if(Array.isArray(e)){for(var a=0,n=Array(e.length);a<e.length;a++)n[a]=e[a];return n}return Array.from(e)}Object.defineProperty(a,"__esModule",{value:!0});var i=function(){return{data:{list:[]},config:{userId:0,userName:"",userUserName:"",userBranchName:"",pageIndex:1,pageSize:20,isLoadAll:!1,isSendAjax:!1,searchAjaxVal:"",searchBox:{searchVal:"",placeholder:"权限名称/管理范围"},modalBox:{isShow:!1,content:"",btn:[{text:"确定",handel:"confirmClick"},{text:"取消",handel:"cancelClick"}]}}}};a.default={data:function(){return new i},activated:function(){var e=this;e.config.userId=parseInt(Bestone.util.query().UserID,10),e.config.userName=Bestone.util.query().UserName||"",e.config.userUserName=Bestone.util.query().UserUserName||"",e.config.userBranchName=Bestone.util.query().UserBranchName||"",Bestone.ui.pageInit({setTitle:"管理账户权限",reviewCallBack:function(){}}),Bestone.ui.ddSetRight({control:!0,text:"日志",show:!0,onSuccess:function(){Bestone.util.vueJump({path:"/log/userLog",query:{UserId:e.config.userId}})}}),e.config.isSendAjax=!0,Bestone.util.ajax({url:"api/UserManage/GetMenuUserConfigAllByUser",data:JSON.stringify({PageIndex:1,PageSize:e.config.pageSize,UserId:e.config.userId,Keyword:e.config.searchAjaxVal}),success:function(a){a.data.list.length<e.config.pageSize&&(e.config.isLoadAll=!0),e.config.pageIndex=1,e.data.list=a.data.list||[]},complete:function(){e.config.isSendAjax=!1}}),Bestone.util.scrollRefresh({callback:function(a){e.config.isSendAjax||e.config.isLoadAll||(e.config.isSendAjax=!0,Bestone.util.ajax({url:"api/UserManage/GetMenuUserConfigAllByUser",showLoad:!1,data:JSON.stringify({PageIndex:e.config.pageIndex+1,PageSize:e.config.pageSize,UserId:e.config.userId,Keyword:e.config.searchAjaxVal}),success:function(a){var n;a.data.list.length<e.config.pageSize&&(e.config.isLoadAll=!0),e.config.pageIndex=a.data.page,(n=e.data.list).push.apply(n,t(a.data.list))},complete:function(){e.config.isSendAjax=!1}}))}})},deactivated:function(){var e=this;Bestone.util.resetData(function(){e.data=i().data,e.config=i().config})},methods:{textStatusDeal:function(e){return Bestone.util.textStatusDeal(e)},mgmt:function(e){var a=this;console.log(e),Bestone.util.vueJump({path:"/permissionControl/accountMgmtDetail",query:{UserID:a.config.userId,UserName:a.config.userName,UserUserName:a.config.userUserName,UserBranchName:a.config.userBranchName,MenuCode:e.Menu_Code,MenuName:e.Menu_Name}})},pageOneClickDeal:function(e){var a=this;a.config.isSendAjax=!0,Bestone.util.ajax({url:"api/UserManage/GetMenuUserConfigAllByUser",data:JSON.stringify({PageIndex:1,PageSize:a.config.pageSize,UserId:a.config.userId,Keyword:e}),success:function(n){a.config.searchAjaxVal=e,a.config.pageIndex=1,n.data.list.length<a.config.pageSize?a.config.isLoadAll=!0:a.config.isLoadAll=!1,a.data.list=n.data.list||[]},complete:function(){a.config.isSendAjax=!1}})},pageOneValChangeDeal:function(e){this.config.searchBox.searchVal=e},clearAll:function(){var e=this;e.config.modalBox.content='<p style="font-size: 14px;text-align: center;padding: 20px 0px;line-height: 16px;">确定清除该账户所有权限？</p>',e.config.modalBox.isShow=!0},confirmClickDeal:function(){var e=this;Bestone.util.ajax({url:"api/UserManage/DeleteMenuUserConfigByUser",data:JSON.stringify({UserId:e.config.userId,OperId:Bestone.user.id,OperName:Bestone.user.name}),success:function(a){e.config.modalBox.isShow=!1,Bestone.ui.message({content:"操作成功！"}),e.config.isSendAjax=!0,Bestone.util.ajax({url:"api/UserManage/GetMenuUserConfigAllByUser",data:JSON.stringify({PageIndex:1,PageSize:e.config.pageSize,UserId:e.config.userId,Keyword:e.config.searchAjaxVal}),success:function(a){e.config.pageIndex=1,a.data.list.length<e.config.pageSize?e.config.isLoadAll=!0:e.config.isLoadAll=!1,e.data.list=a.data.list||[]},complete:function(){e.config.isSendAjax=!1}})}})},cancelClickDeal:function(){this.config.modalBox.isShow=!1}}}},135:function(e,a,n){a=e.exports=n(0)(void 0),a.push([e.i,"#permission-mgmt[data-v-773d3f27]{padding-top:10px}#permission-mgmt>.ui.ui-title[data-v-773d3f27]{margin-top:10px}#permission-mgmt>.search-content[data-v-773d3f27]{background-color:#fff;padding:10px 15px}#permission-mgmt>.no-data[data-v-773d3f27]{color:#999;font-size:12px;line-height:20px;text-align:center;margin-top:50px;padding:0 20px}#permission-mgmt>.no-data>span[data-v-773d3f27]{color:#38adff}",""])},168:function(e,a){e.exports={render:function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("div",[n("div",{attrs:{id:"permission-mgmt"}},[n("div",{staticClass:"ui ui-text-list"},[n("p",[e._v("TDS账号："+e._s(e.config.userName))]),e._v(" "),n("p",[e._v("姓名："+e._s(e.config.userUserName))]),e._v(" "),n("p",[e._v("账号所属公司："+e._s(e.config.userBranchName))])]),e._v(" "),n("div",{staticClass:"ui ui-title"},[e._v("\n            该账户所拥有的权限\n            "),n("v-touch",{staticClass:"right-btn bg-btn bg-red",attrs:{tag:"a"},on:{pressup:function(a){a.preventDefault(),e.clearAll(a)},tap:function(a){a.preventDefault(),e.clearAll(a)}}},[e._v("清除所有权限")])],1),e._v(" "),n("div",{staticClass:"search-content"},[n("search-box",{attrs:{searchVal:e.config.searchBox.searchVal,placeholder:e.config.searchBox.placeholder},on:{searchClick:e.pageOneClickDeal,searchValChange:e.pageOneValChangeDeal}})],1),e._v(" "),e.data.list&&e.data.list.length>0?n("div",{staticClass:"ui ui-card-list"},[n("ul",e._l(e.data.list,function(a,t){return n("li",[n("div",{staticClass:"list-text"},[n("p",[e._v("权限名称："+e._s(a.Menu_Name))]),e._v(" "),n("p",[e._v("管理范围："+e._s(e.textStatusDeal(a.Branch_Name)))])]),e._v(" "),n("v-touch",{staticClass:"btn",attrs:{tag:"div"},on:{pressup:function(n){n.preventDefault(),e.mgmt(a,t)},tap:function(n){n.preventDefault(),e.mgmt(a,t)}}},[e._v("查看详细")])],1)}))]):e._e(),e._v(" "),e.data.list.length>0?n("div",{staticClass:"ui ui-scrollRefresh"},[e.config.isLoadAll?e._e():[n("i",{staticClass:"iconfont icon-load"}),n("span",[e._v("加载中")])],e._v(" "),e.config.isLoadAll?[n("span",[e._v("没有更多了")])]:e._e()],2):e._e(),e._v(" "),e.data.list&&e.data.list.length<=0?n("div",{staticClass:"no-data"},[e._v("暂无数据")]):e._e(),e._v(" "),e._e(),e._v(" "),n("modal-box",{attrs:{setConfig:e.config.modalBox},on:{confirmClick:e.confirmClickDeal,cancelClick:e.cancelClickDeal}})],1)])},staticRenderFns:[]}},199:function(e,a,n){var t=n(135);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);n(2)("7e000e96",t,!0)},71:function(e,a,n){function t(e){n(199)}var i=n(1)(n(102),n(168),t,"data-v-773d3f27",null);e.exports=i.exports}});